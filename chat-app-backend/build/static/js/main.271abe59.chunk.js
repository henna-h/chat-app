(this["webpackJsonpchat-app-frontend"]=this["webpackJsonpchat-app-frontend"]||[]).push([[0],{65:function(e,n,t){"use strict";t.r(n);var r=t(1),a=t(0),c=t(33),o=t.n(c),u=t(6),s=t.n(u),i=t(12),l=t(7),d=t(4),j=t(5),b=function(e){var n=e.register,t=Object(a.useState)(""),c=Object(l.a)(t,2),o=c[0],u=c[1],s=Object(a.useState)(""),i=Object(l.a)(s,2),d=i[0],j=i[1],b=Object(a.useState)(""),p=Object(l.a)(b,2),f=p[0],h=p[1];return Object(r.jsxs)("div",{children:[Object(r.jsx)("h3",{children:"No account? Sign up!"}),Object(r.jsxs)("form",{children:[Object(r.jsx)("div",{children:Object(r.jsx)("input",{value:o,onChange:function(e){u(e.target.value)},placeholder:"username"})}),Object(r.jsx)("div",{children:Object(r.jsx)("input",{type:"password",value:d,onChange:function(e){j(e.target.value)},placeholder:"password"})}),Object(r.jsx)("div",{children:Object(r.jsx)("input",{type:"password",value:f,onChange:function(e){h(e.target.value)},placeholder:"repeat password"})}),Object(r.jsx)("button",{onClick:function(e){e.preventDefault(),n({username:o,password1:d,password2:f})},type:"submit",children:"Sign up"})]})]})},p=function(e){var n=e.login,t=e.users,c=e.register,o=Object(a.useState)(""),u=Object(l.a)(o,2),s=u[0],i=u[1],d=Object(a.useState)(""),j=Object(l.a)(d,2),p=j[0],f=j[1];return Object(r.jsxs)("div",{children:[Object(r.jsx)("h3",{children:"Sign in!"}),Object(r.jsxs)("form",{children:[Object(r.jsx)("div",{children:Object(r.jsx)("input",{value:s,onChange:function(e){i(e.target.value)},placeholder:"username"})}),Object(r.jsx)("div",{children:Object(r.jsx)("input",{type:"password",value:p,onChange:function(e){f(e.target.value)},placeholder:"password"})}),Object(r.jsx)("button",{onClick:function(e){e.preventDefault(),n(s,p)},type:"submit",children:"Login"})]}),Object(r.jsx)(b,{login:n,users:t,register:c})]})},f=t(15);function h(){var e=Object(d.a)(["\n  background: black;\n  padding: 0.75em\n"]);return h=function(){return e},e}function g(){var e=Object(d.a)(["\n  padding: 0.25em;\n  position: absolute;\n  right: 1em;\n  font-size: 1em;\n  color: Azure;\n  font-weight: bold;\n"]);return g=function(){return e},e}function O(){var e=Object(d.a)(["\n  padding: 0.25em;\n  font-size: 1em;\n  color: Azure;\n  font-weight: bold;\n"]);return O=function(){return e},e}var v=Object(j.a)(f.b)(O()),m=Object(j.a)(f.b)(g()),x=j.a.div(h()),w=function(e){var n=e.user,t=e.logOut;return Object(r.jsxs)(x,{children:[Object(r.jsx)(v,{to:"/",children:"Home"}),n?Object(r.jsx)(m,{onClick:t,to:"/#",children:"Log out"}):Object(r.jsx)(m,{to:"/login",children:"Login"})]})},k=t(13),y=t.n(k),S="/api/messages",C=null,A={getAll:function(){return y.a.get(S).then((function(e){return e.data}))},send:function(){var e=Object(i.a)(s.a.mark((function e(n){var t,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={headers:{Authorization:C}},e.next=3,y.a.post(S,n,t);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(i.a)(s.a.mark((function e(n){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={headers:{Authorization:C}},e.next=3,y.a.delete("".concat(S,"/").concat(n),t);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),setToken:function(e){C="bearer ".concat(e)}};function z(){var e=Object(d.a)(["\n  margin: 1em;\n  color: Azure\n"]);return z=function(){return e},e}function T(){var e=Object(d.a)(["\n  margin: 1em;\n  color: PowderBlue;\n  border-style: none none solid none;\n"]);return T=function(){return e},e}var U=j.a.div(T()),I=j.a.div(z()),B=function(e){var n=e.content,t=e.user;return t&&null!==t?(console.log(t.username),Object(r.jsxs)("div",{children:[Object(r.jsxs)(U,{children:[t.username,":"]}),Object(r.jsx)(I,{children:n})]})):Object(r.jsxs)("div",{children:[Object(r.jsx)(U,{children:"anonymous:"}),Object(r.jsx)(I,{children:n})]})};function D(){var e=Object(d.a)(["\n  color: Ivory;\n"]);return D=function(){return e},e}function E(){var e=Object(d.a)(["\n  width: 5em;\n  color: palevioletred;\n  background: transparent;\n  font-size: 1em;\n  border: none;\n  border-bottom: solid PowderBlue;\n"]);return E=function(){return e},e}function J(){var e=Object(d.a)(["\n  min-width: 15em;\n  padding: 0.5em;\n  display: flex;\n  margin: 0.5em;\n  background: black;\n  color: white;\n  border-radius: 3px\n"]);return J=function(){return e},e}function L(){var e=Object(d.a)(["\n  position: relative;\n  margin-left: auto;\n  margin-right: auto;\n  align-items: center;\n  width: 20em;\n  display: flex;\n"]);return L=function(){return e},e}function N(){var e=Object(d.a)(["\n  background: Black;\n  width: 20em;\n  height: 30em;\n  position: relative;\n  right: 5em;\n  margin-left: auto;\n  margin-right: auto;\n  padding: 1em 2em;\n  align-items: center;\n  overflow: scroll;\n"]);return N=function(){return e},e}var H=j.a.div(N()),M=j.a.span(L()),P=j.a.textarea(J()),W=j.a.button(E()),q=j.a.h3(D()),F=function(e){var n=e.user,t=Object(a.useState)([]),c=Object(l.a)(t,2),o=c[0],u=c[1],s=Object(a.useState)(""),i=Object(l.a)(s,2),d=i[0],j=i[1];console.log(n),Object(a.useEffect)((function(){A.getAll().then((function(e){return u(e)}))}),[]);return Object(r.jsxs)("div",{children:[Object(r.jsxs)(H,{children:[Object(r.jsx)(q,{children:"Start Chatting!"}),o.map((function(e){return Object(r.jsx)("div",{children:Object(r.jsx)(B,{user:e.user,content:e.content})},e.id)}))]}),Object(r.jsxs)(M,{children:[Object(r.jsx)(P,{value:d,onChange:function(e){j(e.target.value)}}),Object(r.jsx)(W,{onClick:function(){console.log("user in sendMessage "+n);var e=null;e=null===n?{content:d,date:Date.now(),user:null}:{content:d,date:Date.now(),user:n},A.send(e),u(o.concat(e)),j("")},children:"Send"})]})]})};function G(){var e=Object(d.a)(["\n  padding: 0.25em\n"]);return G=function(){return e},e}function K(){var e=Object(d.a)(["\n  background: Azure\n  padding: 1em\n  position: relative;\n  margin: 0.25em 1em;\n"]);return K=function(){return e},e}var Q=j.a.div(K()),R=j.a.h1(G()),V=function(e){var n=e.message;return null!==n?Object(r.jsx)(Q,{children:Object(r.jsx)(R,{children:n})}):null},X={login:function(){var e=Object(i.a)(s.a.mark((function e(n){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.post("/api/login",n);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},Y="/api/users",Z={getAll:function(){return y.a.get(Y).then((function(e){return e.data}))},create:function(){var e=Object(i.a)(s.a.mark((function e(n){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.post(Y,n);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},$=t(2);function _(){var e=Object(d.a)(["\nposition: relative;\nwidth: 100%;\nalign-items: center;\npadding: 4em;\nbackground: SeaShell\n"]);return _=function(){return e},e}var ee=j.a.div(_()),ne=function(){var e=Object(a.useState)(null),n=Object(l.a)(e,2),t=n[0],c=n[1],o=Object(a.useState)([]),u=Object(l.a)(o,2),d=u[0],j=u[1],b=Object(a.useState)(null),f=Object(l.a)(b,2),h=f[0],g=f[1],O=Object($.g)();Object(a.useEffect)((function(){Z.getAll().then((function(e){return j(e)}))}),[]),Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedChatAppUser");if(e){var n=JSON.parse(e);c(n),console.log("setUser:"+n),A.setToken(n.token),console.log("logged in user: "+n.username)}}),[]);var v=function(){var e=Object(i.a)(s.a.mark((function e(n,t){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("login"),e.prev=1,e.next=4,X.login({username:n,password:t});case 4:r=e.sent,window.localStorage.setItem("loggedChatAppUser",JSON.stringify(r)),A.setToken(r.token),c(r),O.push("/"),g("Hi "+r.username+"!"),setTimeout((function(){g(null)}),5e3),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),g("Wrong username or password"),setTimeout((function(){g(null)}),5e3);case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(n,t){return e.apply(this,arguments)}}(),m=function(){var e=Object(i.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.localStorage.removeItem("loggedChatAppUser"),c(null),g("Logged out!"),setTimeout((function(){g(null)}),3e3);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(i.a)(s.a.mark((function e(n){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d.map((function(e){return e.username})).includes(n.username)){e.next=5;break}g("Username is already taken"),e.next=18;break;case 5:if(!(n.username.length<3||n.password1.length<3)){e.next=9;break}g("Username and password must be at least 3 characters long"),e.next=18;break;case 9:if(n.password1===n.password2){e.next=13;break}g("Make sure password fields match!"),e.next=18;break;case 13:return setTimeout((function(){g(null)})),t={username:n.username,password:n.password1},e.next=17,Z.create(t);case 17:v(t.username,t.password);case 18:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{children:[Object(r.jsx)(w,{user:t,logOut:m}),Object(r.jsx)(V,{message:h}),Object(r.jsx)(ee,{children:Object(r.jsxs)($.d,{children:[Object(r.jsx)($.b,{path:"/login",children:t?Object(r.jsx)($.a,{to:"/"}):Object(r.jsx)(p,{login:v,register:x,users:d})}),Object(r.jsx)($.b,{path:"/",children:Object(r.jsx)(F,{user:t})})]})})]})};o.a.render(Object(r.jsx)(f.a,{history:history,children:Object(r.jsx)(ne,{})}),document.getElementById("root"))}},[[65,1,2]]]);
//# sourceMappingURL=main.271abe59.chunk.js.map