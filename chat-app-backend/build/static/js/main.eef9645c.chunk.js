(this["webpackJsonpchat-app-frontend"]=this["webpackJsonpchat-app-frontend"]||[]).push([[0],{65:function(n,e,t){"use strict";t.r(e);var r=t(1),a=t(0),c=t(33),i=t.n(c),o=t(6),u=t.n(o),s=t(12),l=t(7),d=t(2),b=t(3);function j(){var n=Object(d.a)(["\n  padding: 0.5em;\n  margin: 0.5em;\n  background: white;\n  border: none;\n  border-radius: 3px;\n"]);return j=function(){return n},n}function f(){var n=Object(d.a)(["\n  font-size: 1em;\n  margin: 1em;\n  padding: 0.25em 1em;\n  border-radius: 3px;\n  border: 2px solid;\n  color: white;\n  background: black;\n"]);return f=function(){return n},n}function p(){var n=Object(d.a)(["\n  position: relative;\n  margin-left: auto;\n  margin-right: auto;\n  align-items: center;\n"]);return p=function(){return n},n}var h=b.a.form(p()),g=b.a.button(f()),O=b.a.input(j()),m=function(n){var e=n.register,t=Object(a.useState)(""),c=Object(l.a)(t,2),i=c[0],o=c[1],u=Object(a.useState)(""),s=Object(l.a)(u,2),d=s[0],b=s[1],j=Object(a.useState)(""),f=Object(l.a)(j,2),p=f[0],m=f[1];return Object(r.jsx)("div",{children:Object(r.jsxs)(h,{children:[Object(r.jsx)("h3",{children:"No account? Sign up!"}),Object(r.jsx)("div",{children:Object(r.jsx)(O,{value:i,onChange:function(n){o(n.target.value)},placeholder:"username"})}),Object(r.jsx)("div",{children:Object(r.jsx)(O,{type:"password",value:d,onChange:function(n){b(n.target.value)},placeholder:"password"})}),Object(r.jsx)("div",{children:Object(r.jsx)(O,{type:"password",value:p,onChange:function(n){m(n.target.value)},placeholder:"repeat password"})}),Object(r.jsx)(g,{onClick:function(n){n.preventDefault(),e({username:i,password1:d,password2:p})},type:"submit",children:"Sign up"})]})})};function v(){var n=Object(d.a)(["\n  padding: 0.5em;\n  margin: 0.5em;\n  background: white;\n  border: none;\n  border-radius: 3px;\n"]);return v=function(){return n},n}function x(){var n=Object(d.a)(["\n  font-size: 1em;\n  margin: 1em;\n  padding: 0.25em 1em;\n  border-radius: 3px;\n  border: 2px solid;\n  color: white;\n  background: black;\n"]);return x=function(){return n},n}function w(){var n=Object(d.a)(["\n  position: relative;\n  margin-left: auto;\n  margin-right: auto;\n  align-items: center;\n"]);return w=function(){return n},n}function k(){var n=Object(d.a)(["\n  margin-left: 35%;\n  margin-right: 35%;\n  align-items: center;\n"]);return k=function(){return n},n}var S=b.a.div(k()),y=b.a.form(w()),C=b.a.button(x()),A=b.a.input(v()),z=function(n){var e=n.login,t=n.users,c=n.register,i=Object(a.useState)(""),o=Object(l.a)(i,2),u=o[0],s=o[1],d=Object(a.useState)(""),b=Object(l.a)(d,2),j=b[0],f=b[1];return Object(r.jsxs)(S,{children:[Object(r.jsxs)(y,{children:[Object(r.jsx)("h3",{children:"Sign in!"}),Object(r.jsx)("div",{children:Object(r.jsx)(A,{value:u,onChange:function(n){s(n.target.value)},placeholder:"username"})}),Object(r.jsx)("div",{children:Object(r.jsx)(A,{type:"password",value:j,onChange:function(n){f(n.target.value)},placeholder:"password"})}),Object(r.jsx)(C,{onClick:function(n){n.preventDefault(),e(u,j)},type:"submit",children:"Login"})]}),Object(r.jsx)(m,{login:e,users:t,register:c})]})},T=t(15);function B(){var n=Object(d.a)(["\n  background: black;\n  padding: 0.75em\n"]);return B=function(){return n},n}function U(){var n=Object(d.a)(["\n  padding: 0.25em;\n  position: absolute;\n  right: 1em;\n  font-size: 1em;\n  color: white;\n  font-weight: bold;\n"]);return U=function(){return n},n}function D(){var n=Object(d.a)(["\n  padding: 0.25em;\n  font-size: 1em;\n  color: white;\n  font-weight: bold;\n"]);return D=function(){return n},n}var E=Object(b.a)(T.b)(D()),I=Object(b.a)(T.b)(U()),J=b.a.div(B()),L=function(n){var e=n.user,t=n.logOut;return Object(r.jsxs)(J,{children:[Object(r.jsx)(E,{to:"/",children:"Home"}),e?Object(r.jsx)(I,{onClick:t,to:"/#",children:"Log out"}):Object(r.jsx)(I,{to:"/login",children:"Login"})]})},N=t(13),H=t.n(N),P="/api/messages",M=null,W={getAll:function(){return H.a.get(P).then((function(n){return n.data}))},send:function(){var n=Object(s.a)(u.a.mark((function n(e){var t,r;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t={headers:{Authorization:M}},n.next=3,H.a.post(P,e,t);case 3:return r=n.sent,n.abrupt("return",r.data);case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),remove:function(){var n=Object(s.a)(u.a.mark((function n(e){var t;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t={headers:{Authorization:M}},n.next=3,H.a.delete("".concat(P,"/").concat(e),t);case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),setToken:function(n){M="bearer ".concat(n)}};function q(){var n=Object(d.a)(["\n  margin: 1em;\n  color: white;\n"]);return q=function(){return n},n}function F(){var n=Object(d.a)(["\n  margin: 1em;\n  color: PowderBlue;\n  border-style: none none solid none;\n"]);return F=function(){return n},n}var G=b.a.div(F()),K=b.a.div(q()),Q=function(n){var e=n.content,t=n.user;return t&&null!==t?(console.log(t.username),Object(r.jsxs)("div",{children:[Object(r.jsxs)(G,{children:[t.username,":"]}),Object(r.jsx)(K,{children:e})]})):Object(r.jsxs)("div",{children:[Object(r.jsx)(G,{children:"anonymous:"}),Object(r.jsx)(K,{children:e})]})};function R(){var n=Object(d.a)(["\n  color: white;\n  \n"]);return R=function(){return n},n}function V(){var n=Object(d.a)(["\n  color: Black;\n  background: PowderBlue;;\n  font-size: 1em;\n  padding: 1em;\n  border: none;\n"]);return V=function(){return n},n}function X(){var n=Object(d.a)(["\n  width: 18em;\n  height: 5em;\n  background: white;\n  color: black;\n  overflow: scroll;\n"]);return X=function(){return n},n}function Y(){var n=Object(d.a)(["\n  position: absolute;\n  bottom: 0.5em;\n  display:inline-flex;\n"]);return Y=function(){return n},n}function Z(){var n=Object(d.a)(["\n  overflow: scroll;\n  width: 20em;\n  height: 25em;\n  padding-bottom: 1em;\n"]);return Z=function(){return n},n}function $(){var n=Object(d.a)(["\n  background: Black;\n  width: 20em;\n  height: 35em;\n  position: relative;\n  right: 5em;\n  margin-left: auto;\n  margin-right: auto;\n  padding: 1em 2em;\n  align-items: center;\n"]);return $=function(){return n},n}var _=b.a.div($()),nn=b.a.div(Z()),en=b.a.span(Y()),tn=b.a.textarea(X()),rn=b.a.button(V()),an=b.a.h3(R()),cn=function(n){var e=n.user,t=Object(a.useState)([]),c=Object(l.a)(t,2),i=c[0],o=c[1],u=Object(a.useState)(""),s=Object(l.a)(u,2),d=s[0],b=s[1];console.log(e),Object(a.useEffect)((function(){W.getAll().then((function(n){return o(n)}))}),[]);return Object(r.jsx)("div",{children:Object(r.jsxs)(_,{children:[Object(r.jsx)(an,{children:"Start Chatting!"}),Object(r.jsx)(nn,{children:i.map((function(n){return Object(r.jsx)("div",{children:Object(r.jsx)(Q,{user:n.user,content:n.content})},n.id)}))}),Object(r.jsxs)(en,{children:[Object(r.jsx)(tn,{value:d,onChange:function(n){b(n.target.value)}}),Object(r.jsx)(rn,{onClick:function(){var n=null;n=null===e?{content:d,date:Date.now(),user:null}:{content:d,date:Date.now(),user:e},W.send(n),o(i.concat(n)),b("")},children:"Send"})]})]})})};function on(){var n=Object(d.a)(["\n  padding: 0.25em\n"]);return on=function(){return n},n}function un(){var n=Object(d.a)(["\n  background: white\n  padding: 1em\n  position: relative;\n  margin: 0.25em 1em;\n"]);return un=function(){return n},n}var sn=b.a.div(un()),ln=b.a.h1(on()),dn=function(n){var e=n.message;return null!==e?Object(r.jsx)(sn,{children:Object(r.jsx)(ln,{children:e})}):null},bn={login:function(){var n=Object(s.a)(u.a.mark((function n(e){var t;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,H.a.post("/api/login",e);case 2:return t=n.sent,n.abrupt("return",t.data);case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},jn="/api/users",fn={getAll:function(){return H.a.get(jn).then((function(n){return n.data}))},create:function(){var n=Object(s.a)(u.a.mark((function n(e){var t;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,H.a.post(jn,e);case 2:return t=n.sent,n.abrupt("return",t.data);case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},pn=t(4);function hn(){var n=Object(d.a)(["\nposition: relative;\nwidth: 100%;\nheight: 100%;\nalign-items: center;\npadding: 4em;\nbackground: SeaShell\n"]);return hn=function(){return n},n}var gn=b.a.div(hn()),On=function(){var n=Object(a.useState)(null),e=Object(l.a)(n,2),t=e[0],c=e[1],i=Object(a.useState)([]),o=Object(l.a)(i,2),d=o[0],b=o[1],j=Object(a.useState)(null),f=Object(l.a)(j,2),p=f[0],h=f[1],g=Object(pn.g)();Object(a.useEffect)((function(){fn.getAll().then((function(n){return b(n)}))}),[]),Object(a.useEffect)((function(){var n=window.localStorage.getItem("loggedChatAppUser");if(n){var e=JSON.parse(n);c(e),W.setToken(e.token)}}),[]);var O=function(){var n=Object(s.a)(u.a.mark((function n(e,t){var r;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,bn.login({username:e,password:t});case 3:r=n.sent,window.localStorage.setItem("loggedChatAppUser",JSON.stringify(r)),W.setToken(r.token),c(r),g.push("/"),h("Hi "+r.username+"!"),setTimeout((function(){h(null)}),5e3),n.next=16;break;case 12:n.prev=12,n.t0=n.catch(0),h("Wrong username or password"),setTimeout((function(){h(null)}),5e3);case 16:case"end":return n.stop()}}),n,null,[[0,12]])})));return function(e,t){return n.apply(this,arguments)}}(),m=function(){var n=Object(s.a)(u.a.mark((function n(){return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:window.localStorage.removeItem("loggedChatAppUser"),c(null),h("Logged out!"),setTimeout((function(){h(null)}),3e3);case 4:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),v=function(){var n=Object(s.a)(u.a.mark((function n(e){var t;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!d.map((function(n){return n.username})).includes(e.username)){n.next=5;break}h("Username is already taken"),n.next=18;break;case 5:if(!(e.username.length<3||e.password1.length<3)){n.next=9;break}h("Username and password must be at least 3 characters long"),n.next=18;break;case 9:if(e.password1===e.password2){n.next=13;break}h("Make sure password fields match!"),n.next=18;break;case 13:return setTimeout((function(){h(null)})),t={username:e.username,password:e.password1},n.next=17,fn.create(t);case 17:O(t.username,t.password);case 18:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return Object(r.jsxs)("div",{children:[Object(r.jsx)(L,{user:t,logOut:m}),Object(r.jsx)(dn,{message:p}),Object(r.jsx)(gn,{children:Object(r.jsxs)(pn.d,{children:[Object(r.jsx)(pn.b,{path:"/login",children:t?Object(r.jsx)(pn.a,{to:"/"}):Object(r.jsx)(z,{login:O,register:v,users:d})}),Object(r.jsx)(pn.b,{path:"/",children:Object(r.jsx)(cn,{user:t})})]})})]})};i.a.render(Object(r.jsx)(T.a,{history:history,children:Object(r.jsx)(On,{})}),document.getElementById("root"))}},[[65,1,2]]]);
//# sourceMappingURL=main.eef9645c.chunk.js.map