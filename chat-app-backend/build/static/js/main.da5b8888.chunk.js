(this["webpackJsonpchat-app-frontend"]=this["webpackJsonpchat-app-frontend"]||[]).push([[0],{65:function(e,n,t){"use strict";t.r(n);var r=t(1),a=t(0),c=t(33),o=t.n(c),u=t(6),s=t.n(u),i=t(12),l=t(7),d=t(3),j=t(4),b=function(e){var n=e.register,t=Object(a.useState)(""),c=Object(l.a)(t,2),o=c[0],u=c[1],s=Object(a.useState)(""),i=Object(l.a)(s,2),d=i[0],j=i[1],b=Object(a.useState)(""),f=Object(l.a)(b,2),p=f[0],h=f[1];return Object(r.jsxs)("div",{children:[Object(r.jsx)("h3",{children:"No account? Sign up!"}),Object(r.jsxs)("form",{children:[Object(r.jsx)("div",{children:Object(r.jsx)("input",{value:o,onChange:function(e){u(e.target.value)},placeholder:"username"})}),Object(r.jsx)("div",{children:Object(r.jsx)("input",{type:"password",value:d,onChange:function(e){j(e.target.value)},placeholder:"password"})}),Object(r.jsx)("div",{children:Object(r.jsx)("input",{type:"password",value:p,onChange:function(e){h(e.target.value)},placeholder:"repeat password"})}),Object(r.jsx)("button",{onClick:function(e){e.preventDefault(),n({username:o,password1:d,password2:p})},type:"submit",children:"Sign up"})]})]})},f=function(e){var n=e.login,t=e.users,c=e.register,o=Object(a.useState)(""),u=Object(l.a)(o,2),s=u[0],i=u[1],d=Object(a.useState)(""),j=Object(l.a)(d,2),f=j[0],p=j[1];return Object(r.jsxs)("div",{children:[Object(r.jsx)("h3",{children:"Sign in!"}),Object(r.jsxs)("form",{children:[Object(r.jsx)("div",{children:Object(r.jsx)("input",{value:s,onChange:function(e){i(e.target.value)},placeholder:"username"})}),Object(r.jsx)("div",{children:Object(r.jsx)("input",{type:"password",value:f,onChange:function(e){p(e.target.value)},placeholder:"password"})}),Object(r.jsx)("button",{onClick:function(e){e.preventDefault(),n(s,f)},type:"submit",children:"Login"})]}),Object(r.jsx)(b,{login:n,users:t,register:c})]})},p=t(15);function h(){var e=Object(d.a)(["\n  background: black;\n  padding: 0.75em\n"]);return h=function(){return e},e}function O(){var e=Object(d.a)(["\n  padding: 0.25em;\n  position: absolute;\n  right: 1em;\n  font-size: 1em;\n  color: Azure;\n  font-weight: bold;\n"]);return O=function(){return e},e}function g(){var e=Object(d.a)(["\n  padding: 0.25em;\n  font-size: 1em;\n  color: Azure;\n  font-weight: bold;\n"]);return g=function(){return e},e}var v=Object(j.a)(p.b)(g()),m=Object(j.a)(p.b)(O()),x=j.a.div(h()),w=function(e){var n=e.user,t=e.logOut;return Object(r.jsxs)(x,{children:[Object(r.jsx)(v,{to:"/",children:"Home"}),n?Object(r.jsx)(m,{onClick:t,to:"/#",children:"Log out"}):Object(r.jsx)(m,{to:"/login",children:"Login"})]})},k=t(13),y=t.n(k),S="/api/messages",C=null,A={getAll:function(){return y.a.get(S).then((function(e){return e.data}))},send:function(){var e=Object(i.a)(s.a.mark((function e(n){var t,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={headers:{Authorization:C}},e.next=3,y.a.post(S,n,t);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(i.a)(s.a.mark((function e(n){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={headers:{Authorization:C}},e.next=3,y.a.delete("".concat(S,"/").concat(n),t);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),setToken:function(e){C="bearer ".concat(e)}};function z(){var e=Object(d.a)(["\n  margin: 1em;\n  color: Azure\n"]);return z=function(){return e},e}function T(){var e=Object(d.a)(["\n  margin: 1em;\n  color: PowderBlue;\n  border-style: none none solid none;\n"]);return T=function(){return e},e}var I=j.a.div(T()),U=j.a.div(z()),D=function(e){var n=e.content,t=e.user;return t&&null!==t?(console.log(t.username),Object(r.jsxs)("div",{children:[Object(r.jsxs)(I,{children:[t.username,":"]}),Object(r.jsx)(U,{children:n})]})):Object(r.jsxs)("div",{children:[Object(r.jsx)(I,{children:"anonymous:"}),Object(r.jsx)(U,{children:n})]})};function B(){var e=Object(d.a)(["\n  color: Ivory;\n  \n"]);return B=function(){return e},e}function E(){var e=Object(d.a)(["\n  color: DarkCyan;\n  background: Ivory;\n  font-size: 1em;\n  padding: 1em;\n  border: none;\n  border: 0.25em solid PowderBlue;\n"]);return E=function(){return e},e}function J(){var e=Object(d.a)(["\n  width: 18em;\n  height: 5em;\n  background: Azure;\n  color: black;\n  overflow: scroll;\n"]);return J=function(){return e},e}function L(){var e=Object(d.a)(["\n  position: absolute;\n  bottom: 0.5em;\n  display:inline-flex;\n"]);return L=function(){return e},e}function N(){var e=Object(d.a)(["\n  overflow: scroll;\n  width: 20em;\n  height: 25em;\n  padding-bottom: 1em;\n"]);return N=function(){return e},e}function H(){var e=Object(d.a)(["\n  background: Black;\n  width: 20em;\n  height: 35em;\n  position: relative;\n  right: 5em;\n  margin-left: auto;\n  margin-right: auto;\n  padding: 1em 2em;\n  align-items: center;\n"]);return H=function(){return e},e}var P=j.a.div(H()),M=j.a.div(N()),W=j.a.span(L()),q=j.a.textarea(J()),F=j.a.button(E()),G=j.a.h3(B()),K=function(e){var n=e.user,t=Object(a.useState)([]),c=Object(l.a)(t,2),o=c[0],u=c[1],s=Object(a.useState)(""),i=Object(l.a)(s,2),d=i[0],j=i[1];console.log(n),Object(a.useEffect)((function(){A.getAll().then((function(e){return u(e)}))}),[]);return Object(r.jsx)("div",{children:Object(r.jsxs)(P,{children:[Object(r.jsx)(G,{children:"Start Chatting!"}),Object(r.jsx)(M,{children:o.map((function(e){return Object(r.jsx)("div",{children:Object(r.jsx)(D,{user:e.user,content:e.content})},e.id)}))}),Object(r.jsxs)(W,{children:[Object(r.jsx)(q,{value:d,onChange:function(e){j(e.target.value)}}),Object(r.jsx)(F,{onClick:function(){var e=null;e=null===n?{content:d,date:Date.now(),user:null}:{content:d,date:Date.now(),user:n},A.send(e),u(o.concat(e)),j("")},children:"Send"})]})]})})};function Q(){var e=Object(d.a)(["\n  padding: 0.25em\n"]);return Q=function(){return e},e}function R(){var e=Object(d.a)(["\n  background: Azure\n  padding: 1em\n  position: relative;\n  margin: 0.25em 1em;\n"]);return R=function(){return e},e}var V=j.a.div(R()),X=j.a.h1(Q()),Y=function(e){var n=e.message;return null!==n?Object(r.jsx)(V,{children:Object(r.jsx)(X,{children:n})}):null},Z={login:function(){var e=Object(i.a)(s.a.mark((function e(n){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.post("/api/login",n);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},$="/api/users",_={getAll:function(){return y.a.get($).then((function(e){return e.data}))},create:function(){var e=Object(i.a)(s.a.mark((function e(n){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.post($,n);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},ee=t(2);function ne(){var e=Object(d.a)(["\nposition: relative;\nwidth: 100%;\nalign-items: center;\npadding: 4em;\nbackground: SeaShell\n"]);return ne=function(){return e},e}var te=j.a.div(ne()),re=function(){var e=Object(a.useState)(null),n=Object(l.a)(e,2),t=n[0],c=n[1],o=Object(a.useState)([]),u=Object(l.a)(o,2),d=u[0],j=u[1],b=Object(a.useState)(null),p=Object(l.a)(b,2),h=p[0],O=p[1],g=Object(ee.g)();Object(a.useEffect)((function(){_.getAll().then((function(e){return j(e)}))}),[]),Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedChatAppUser");if(e){var n=JSON.parse(e);c(n),console.log("setUser:"+n),A.setToken(n.token),console.log("logged in user: "+n.username)}}),[]);var v=function(){var e=Object(i.a)(s.a.mark((function e(n,t){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("login"),e.prev=1,e.next=4,Z.login({username:n,password:t});case 4:r=e.sent,window.localStorage.setItem("loggedChatAppUser",JSON.stringify(r)),A.setToken(r.token),c(r),g.push("/"),O("Hi "+r.username+"!"),setTimeout((function(){O(null)}),5e3),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),O("Wrong username or password"),setTimeout((function(){O(null)}),5e3);case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(n,t){return e.apply(this,arguments)}}(),m=function(){var e=Object(i.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.localStorage.removeItem("loggedChatAppUser"),c(null),O("Logged out!"),setTimeout((function(){O(null)}),3e3);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(i.a)(s.a.mark((function e(n){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d.map((function(e){return e.username})).includes(n.username)){e.next=5;break}O("Username is already taken"),e.next=18;break;case 5:if(!(n.username.length<3||n.password1.length<3)){e.next=9;break}O("Username and password must be at least 3 characters long"),e.next=18;break;case 9:if(n.password1===n.password2){e.next=13;break}O("Make sure password fields match!"),e.next=18;break;case 13:return setTimeout((function(){O(null)})),t={username:n.username,password:n.password1},e.next=17,_.create(t);case 17:v(t.username,t.password);case 18:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{children:[Object(r.jsx)(w,{user:t,logOut:m}),Object(r.jsx)(Y,{message:h}),Object(r.jsx)(te,{children:Object(r.jsxs)(ee.d,{children:[Object(r.jsx)(ee.b,{path:"/login",children:t?Object(r.jsx)(ee.a,{to:"/"}):Object(r.jsx)(f,{login:v,register:x,users:d})}),Object(r.jsx)(ee.b,{path:"/",children:Object(r.jsx)(K,{user:t})})]})})]})};o.a.render(Object(r.jsx)(p.a,{history:history,children:Object(r.jsx)(re,{})}),document.getElementById("root"))}},[[65,1,2]]]);
//# sourceMappingURL=main.da5b8888.chunk.js.map